{% extends "layouts/main.html" %}

{% from "components/service-header/macro.njk" import serviceHeader %}

{% block header %}
{{ serviceHeader({
organisationName: "Defra",
productName: "Form Designer",
serviceName: "",
accountName: "Chris Smith",
homepageLink: "/",
signOutLink: "/titan-mvp-1.2/onboarding/sign-out-confirmation",
navigationItems: [
{
href: "/titan-mvp-1.2/library.html",
text: "Forms library",
id: "nav-library"
},
{
href: "/titan-mvp-1.2/form-overview/draft/complete.html",
text: "Overview",
id: "nav-overview"
},{
href: "/titan-mvp-1.2/form-editor/listing",
text: 'Editor',
id: 'nav-editor'
}],
activeLinkId: "/"
}) }}
{% endblock %}

{% block content %}
<div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
        {# <span class="govuk-caption-xl">{{ form.name }}</span>
        <h1 class="govuk-heading-xl">AI review</h1> #}

        {# <div class="govuk-notification-banner" role="alert" aria-labelledby="govuk-notification-banner-title">
            <div class="govuk-notification-banner__header">
                <h2 class="govuk-notification-banner__title" id="govuk-notification-banner-title">
                    Analyzing your form
                </h2>
            </div>
            <div class="govuk-notification-banner__content">
                <p class="govuk-notification-banner__heading">
                    Our AI is checking your form against GDS standards...
                </p>
                <p class="govuk-body">This usually takes 10-30 seconds.</p>
            </div>
        </div> #}

        <!-- Loading Animation -->
        <div class="govuk-body" style="text-align: center; padding: 40px 0;">
            <div class="govuk-body-l" style="margin-bottom: 20px;">
                <div class="loading-spinner"
                    style="display: inline-block; width: 40px; height: 40px; border: 4px solid #f3f2f1; border-top: 4px solid #00703c; border-radius: 50%; animation: spin 1s linear infinite; margin-right: 15px;">
                </div>
                Analyzing form content...
            </div>

            <div class="govuk-body-s" style="color: #6b7280;">
                <div id="loading-messages">
                    <div class="loading-message">Checking content clarity...</div>
                    <div class="loading-message" style="display: none;">Analyzing form structure...</div>
                    <div class="loading-message" style="display: none;">Reviewing accessibility...</div>
                    <div class="loading-message" style="display: none;">Evaluating user experience...</div>
                    <div class="loading-message" style="display: none;">Generating recommendations...</div>
                </div>
            </div>
        </div>

        <!-- What's being checked -->
        <h2 class="govuk-heading-l">What we're checking</h2>

        <div class="govuk-grid-row">
            <div class="govuk-grid-column-one-half">
                <div class="govuk-card govuk-card--contained">
                    <div class="govuk-card__content">
                        <h3 class="govuk-heading-s">Content Quality</h3>
                        <ul class="govuk-list govuk-list--bullet govuk-body-s">
                            <li>Plain English usage</li>
                            <li>Clarity and conciseness</li>
                            <li>User-centered language</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="govuk-grid-column-one-half">
                <div class="govuk-card govuk-card--contained">
                    <div class="govuk-card__content">
                        <h3 class="govuk-heading-s">Form Design</h3>
                        <ul class="govuk-list govuk-list--bullet govuk-body-s">
                            <li>Required field completeness</li>
                            <li>Logical question order</li>
                            <li>Clear field labels</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <div class="govuk-grid-row">
            <div class="govuk-grid-column-one-half">
                <div class="govuk-card govuk-card--contained">
                    <div class="govuk-card__content">
                        <h3 class="govuk-heading-s">Accessibility</h3>
                        <ul class="govuk-list govuk-list--bullet govuk-body-s">
                            <li>Data protection compliance</li>
                            <li>Privacy notice requirements</li>
                            <li>Screen reader compatibility</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="govuk-grid-column-one-half">
                <div class="govuk-card govuk-card--contained">
                    <div class="govuk-card__content">
                        <h3 class="govuk-heading-s">User Experience</h3>
                        <ul class="govuk-list govuk-list--bullet govuk-body-s">
                            <li>Form length optimization</li>
                            <li>User journey clarity</li>
                            <li>Progress indication</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Cancel button -->
        <div class="govuk-button-group">
            <a href="/titan-mvp-1.2/form-overview/index" class="govuk-button govuk-button--secondary">
                Cancel
            </a>
        </div>
    </div>

    {# <div class="govuk-grid-column-one-third">
        <div class="govuk-card govuk-card--contained">
            <div class="govuk-card__content">
                <h3 class="govuk-heading-s">About AI Compliance Checking</h3>
                <p class="govuk-body-s">
                    Our AI analyzes your form against Government Digital Service (GDS) standards to help ensure
                    your form provides the best possible user experience.
                </p>
                <p class="govuk-body-s">
                    The AI checks for common issues and provides specific recommendations to improve your form's
                    compliance and usability.
                </p>
            </div>
        </div>

        <div class="govuk-card govuk-card--contained">
            <div class="govuk-card__content">
                <h3 class="govuk-heading-s">GDS Standards</h3>
                <p class="govuk-body-s">
                    These checks are based on the Government Digital Service Design System and Service Manual,
                    which provide best practices for government digital services.
                </p>
                <a href="https://design-system.service.gov.uk/" target="_blank" class="govuk-link govuk-body-s">
                    Learn more about GDS standards
                </a>
            </div>
        </div>
    </div> #}
</div>

<style>
    @keyframes spin {
        0% {
            transform: rotate(0deg);
        }

        100% {
            transform: rotate(360deg);
        }
    }

    .loading-message {
        transition: opacity 0.5s ease-in-out;
    }
</style>

<script>
    // Simulate loading messages and redirect to results
    document.addEventListener('DOMContentLoaded', function () {
        const messages = document.querySelectorAll('.loading-message');
        let currentMessage = 0;

        function showNextMessage() {
            if (currentMessage < messages.length) {
                // Hide current message
                if (currentMessage > 0) {
                    messages[currentMessage - 1].style.display = 'none';
                }

                // Show next message
                messages[currentMessage].style.display = 'block';
                currentMessage++;

                // Schedule next message
                setTimeout(showNextMessage, 2000);
            }
        }

        // Start the message rotation
        setTimeout(showNextMessage, 1000);

        // Redirect to compliance check results after 8 seconds (simulating AI processing)
        setTimeout(function () {
            window.location.href = '/titan-mvp-1.2/form-overview/manage-form/make-draft-live/ai-compliance-check';
        }, 8000);
    });
</script>
{% endblock %}