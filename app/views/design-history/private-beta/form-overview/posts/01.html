{% extends "layouts/main.html" %}

{% block pageTitle %}
Prototypes â€“ {{ serviceName }} - Product information
{% endblock %}

{% from "components/service-header/macro.njk" import serviceHeader %}
{% from "side-navigation/macro.njk" import dwpSideNavigation %}
{% from "govuk/components/table/macro.njk" import govukTable %}
{% from "govuk/components/tabs/macro.njk" import govukTabs %}

{% set pageName = "Forms Designer prototypes" %}

{% block header %}
{{ serviceHeader({
organisationName: "Defra",
productName: "Forms Designer",
serviceName: "Design history",
accountName: "Account",
containerClasses: containerClasses,
homepageLink: "/design-system/components.html",
navigationItems: [
{ href: "/index", text: "Prototypes", id: "prototype" }
],
activeLinkId: ""
}) }}

{{ xGovukMasthead({
title: {
text: "Form overview pages"
},
description: {
text: "How this features has been iterated and tested."
}
}) }}

{% endblock %}

{% block content %}
<div class="govuk-grid-row">
    <div class="govuk-grid-column-full govuk-grid-column-two-thirds-from-desktop govuk-grid-column-full-from-tablet">
        <h2 class="govuk-heading-l">Features</h2>
        <div class="govuk-inset-text">
            <h3 class="govuk-heading-s">Understanding the design process</h3>
            <p class="govuk-body">Each feature has gone through multiple rounds of user research and testing. The design
                history link provides access to:</p>
            <ul class="govuk-list govuk-list--bullet">
                <li>Research findings and insights</li>
                <li>Design iterations and improvements</li>
                <li>User feedback and testing results</li>
                <li>Implementation decisions and rationale</li>
            </ul>
        </div>


        {% set tableData = [] %}
        {% for feature in sortedFeatures %}
        {% set tableData = (tableData.push([
        { text: feature.name },
        { text: feature.problem },
        { html: '<strong class="govuk-tag govuk-tag--' + feature.statusClass + '">' + feature.status + '</strong>' },
        { text: feature.phase },
        { html: '<a class="govuk-link" href="' + feature.designHistoryHref + '">View<span
                class="govuk-visually-hidden">for
                ' + feature.name + '</span></a>' }
        ]), tableData) %}
        {% endfor %}

        {{ govukTable({
        attributes: {
        "data-module": "moj-sortable-table"
        },
        head: [
        { text: "Feature", classes: "govuk-!-width-one-quarter", attributes: { "aria-sort": "ascending" } },
        { text: "Problem statement", classes: "govuk-!-width-one-quarter" },
        { text: "Status", classes: "govuk-!-width-one-quarter", attributes: { "aria-sort": "none" } },
        { text: "Phase", classes: "govuk-!-width-one-quarter", attributes: { "aria-sort": "none" } },
        { text: "Design history", classes: "govuk-!-width-one-quarter" }
        ],
        rows: tableData
        }) }}

    </div>

    <div class="govuk-grid-column-full govuk-grid-column-two-thirds-from-desktop">
        <h2 class="govuk-heading-l govuk-!-margin-top-6">Design System</h2>
        <p class="govuk-body">
            Explore our <a class="govuk-link--no-visited-state" href="/design-system/components.html">design system
                components</a> and <a class="govuk-link--no-visited-state"
                href="/design-system/user-journeys/home.html">user
                journeys</a>.
        </p>

        <hr class="govuk-section-break govuk-section-break--xl govuk-section-break--visible">

        <h2 class="govuk-heading-l">Documentation</h2>
        <h3 class="govuk-heading-m">Editor Components</h3>
        <p class="govuk-body"><a class="govuk-link--no-visited-state"
                href="/design-system/editor/configuration-panel.html">Configuration panels</a></p>
        <p class="govuk-body"><a class="govuk-link--no-visited-state"
                href="/design-system/editor/guided-input.html">Guided
                input</a></p>
        <p class="govuk-body"><a class="govuk-link--no-visited-state"
                href="/design-system/editor/preview-panel.html">Preview panels</a></p>

        <h3 class="govuk-heading-m">Form Management</h3>
        <p class="govuk-body"><a class="govuk-link--no-visited-state" href="/design-system/reordering/pages.html">Page
                reordering</a></p>
        <p class="govuk-body"><a class="govuk-link--no-visited-state"
                href="/design-system/reordering/questions.html">Question reordering</a></p>
        <p class="govuk-body"><a class="govuk-link--no-visited-state" href="/design-system/deletion/pages.html">Page
                deletion</a></p>
    </div>
</div>

{% endblock %}

{% block pageScripts %}
<script src="/public/javascripts/moj-sortable-table.js"></script>
<script>
    // Sort table rows by status
    function sortTableByStatus() {
        const tables = document.querySelectorAll('.govuk-table')
        tables.forEach(table => {
            const tbody = table.querySelector('tbody')
            const rows = Array.from(tbody.querySelectorAll('tr'))

            // Sort rows - "In progress" first, then "Tested"
            rows.sort((a, b) => {
                const statusA = a.querySelector('.govuk-tag').textContent.trim()
                const statusB = b.querySelector('.govuk-tag').textContent.trim()

                if (statusA === 'In progress' && statusB !== 'In progress') return -1
                if (statusA !== 'In progress' && statusB === 'In progress') return 1
                return 0
            })

            // Re-append rows in sorted order
            rows.forEach(row => tbody.appendChild(row))
        })
    }

    // Run the sort when the page loads
    document.addEventListener('DOMContentLoaded', sortTableByStatus)
</script>
{% endblock %}